/* ---------- Theme tokens ---------- */
:root{
  --bg:#0c0c0c;
  --panel:#141414;
  --muted:#1d1d1d;
  --text:#e6e3d7;
  --sub:#b9b39a;
  --gold:#d4af37;
  --line:#61521a;

  --topbar-h:56px;
  --sidebar-w:320px;
  --gap:16px;

  --shadow:0 8px 24px rgba(0,0,0,.35);
  --ring:0 0 0 1px rgba(212,175,55,.25);
  --radius:12px;

  color-scheme: dark;
}

*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0;
  font:16px/1.5 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
  background:var(--bg);
  color:var(--text);
}

/* ---------- Top bar ---------- */
.topbar{
  position:sticky; top:0; z-index:50;
  height:var(--topbar-h);
  display:flex; align-items:center; gap:12px;
  padding:0 12px 0 8px;
  background:linear-gradient(180deg, #0f0f0f, #0b0b0b);
  border-bottom:1px solid #151515;
  box-shadow:var(--shadow);
}

.icon-btn{
  min-width:44px; height:36px; padding:0 10px;
  display:inline-grid; place-items:center;
  border-radius:10px; border:1px solid #262626;
  background:#121212; color:var(--text);
  cursor:pointer; user-select:none;
}
.icon-btn:focus-visible{ outline:2px solid var(--gold) }

.primary-nav{
  display:flex; gap:18px;
  align-items:center;
  padding-left:4px;
}
.primary-nav a{
  color:var(--gold); text-decoration:none; font-weight:600; letter-spacing:.2px;
}
.primary-nav .brand{ margin-right:6px }

.spacer{ flex:1 }

/* ---------- Layout ---------- */
#appLayout{
  display:flex;
  min-height:calc(100vh - var(--topbar-h));
}

/* Sidebar */
.sidebar{
  position:relative;
  width:var(--sidebar-w);
  flex:0 0 var(--sidebar-w);
  background:var(--panel);
  border-right:1px solid #191919;
  overflow:auto; /* independent scroll */
  will-change:transform;
  transition:transform .25s ease;
  z-index:20;
}

/* Desktop collapse support */
body.sidebar-collapsed .sidebar{
  transform:translateX(calc(-1 * var(--sidebar-w)));
}
body.sidebar-collapsed .content{
  margin-left:0;
}

/* Mobile overlay behaviour */
@media (max-width: 1024px){
  .sidebar{
    position:fixed; inset:var(--topbar-h) auto 0 0;
    max-height:calc(100vh - var(--topbar-h));
    box-shadow:var(--shadow);
    transform:translateX(-100%);
  }
  body.sidebar-open .sidebar{ transform:none }
}

/* Content area */
.content{
  position:relative;
  flex:1 1 auto;
  margin-left:var(--sidebar-w);
  padding:20px clamp(12px, 3vw, 28px);
  transition:margin-left .25s ease;
}
@media (max-width:1024px){
  .content{ margin-left:0 }
}

/* When desktop collapsed via toggle button */
@media (min-width:1025px){
  body.sidebar-open .sidebar{ transform:none }
  body.sidebar-open .content{ margin-left:var(--sidebar-w) }
}

/* Sidebar header */
.side-head{
  position:sticky; top:0; z-index:5;
  background:linear-gradient(180deg, #171717, #131313);
  border-bottom:1px solid #1c1c1c;
  padding:10px;
}
.filters{ display:flex; gap:8px; align-items:center }
.filters select{
  height:34px; background:#101010; color:var(--text);
  border:1px solid #2a2a2a; border-radius:10px; padding:0 8px;
}
.search{ margin-top:8px }
.search input{
  width:100%; height:36px; background:#0e0e0e; color:var(--text);
  border:1px solid #252525; border-radius:10px; padding:0 10px;
}

/* Tree list */
.tree{ padding:10px }
.tree a{
  display:block; padding:8px 10px; margin:2px 0;
  border-radius:10px;
  color:var(--text); text-decoration:none;
}
.tree a:hover{ background:#111 }
.tree .meta{ color:var(--sub); font-size:.85rem }

/* Viewer */
.viewer{
  background:radial-gradient(1200px 600px at 20% 10%, rgba(212,175,55,.05), transparent 60%);
  border:1px solid #1a1a1a;
  border-radius:var(--radius);
  padding:clamp(16px, 2.5vw, 32px);
  box-shadow:var(--ring);
  min-height:40vh; /* no giant fixed heights */
}
.viewer .empty{ opacity:.75 }
.viewer h1,h2,h3{ color:var(--gold); margin:0 0 .75rem }
.viewer h1{ font-size:clamp(1.8rem, 4vw, 2.6rem) }
.viewer blockquote{
  margin:1rem 0; padding:0 0 0 1rem; border-left:4px solid var(--line); color:var(--sub)
}
.viewer hr{ border:0; border-top:1px solid #222; margin:1.5rem 0 }
.viewer img, .viewer iframe{ max-width:100%; display:block; border-radius:12px }

/* Prev/Next (optional anchors you add in content) */
.pager{ display:flex; justify-content:space-between; margin-top:2rem; color:var(--sub) }

/* Utilities */
.visually-hidden{
  position:absolute !important; height:1px; width:1px; overflow:hidden;
  clip:rect(1px,1px,1px,1px); white-space:nowrap;
}